# What I want to do:

**Create beautiful images of code & command output for slides**

code -> png

# Prior art

carbon.now.sh is great, but falls short:

* Doesn't let me customize the color scheme the way I want.
* Doesn't let me manually highlight/colorize things.
* Doesn't work with console output (ansi escape sequences).
* Requires manual copy & pasting into the website and then exporting the image.

# Okay, so how to get from code to png?

First, syntax highlight!

- Pygments (& I already have a witchhazel theme for it)
- Pygments has formatters for HTML, SVG, and a few image formatters that might be helpful? http://pygments.org/docs/formatters/

Directly draw to an image?

- Pillow?
- Cairo/pycairo?
- Skia? (No usuable Python bindings)

Draw to something else, then convert that to an image?
- Write HTML or SVG then convert. Quite painful, would require using chrome headless. See https://stackoverflow.com/questions/10721884/render-html-to-an-image

# Working theory

1. Adapt Pygment's image formatter to my liking, and add support for directly passing it some lines.
2. Accept Pygment's formatter as-is, and then just plaster it onto my own window frame.

https://bitbucket.org/birkenfeld/pygments-main/src/0bcf355df9fbe55d3753256c01260f48fa01e794/pygments/formatters/img.py?at=default&fileviewer=file-view-default

# Customization from here.

Make it look like a window.
80 columns.
Rows to be as many as needed.
A nice, rounded, rectangular border.
A drop shadow.

# What we want to do with Pillow

1. Import the image generated by pygments. (did that)
2. Draw a nice rounded rectangle window with the same background color as the pygments image. (did that)
3. Draw a drop shadow for that window.
4. Draw the pygments image into the window. (did that)
5. Save it. (did that)

# Pillow research

- https://pillow.readthedocs.io/en/stable/handbook/tutorial.html#reading-from-a-string
- https://pillow.readthedocs.io/en/stable/handbook/tutorial.html#copying-a-subrectangle-from-an-image
- https://pillow.readthedocs.io/en/stable/handbook/tutorial.html#simple-geometry-transforms
- https://pillow.readthedocs.io/en/stable/handbook/tutorial.html#drawing-postscript
- http://code.activestate.com/recipes/474116-drop-shadows-with-pil/
- Drawing a rounded rectangle: https://stackoverflow.com/a/50145023
- https://en.wikibooks.org/wiki/Python_Imaging_Library/Drop_Shadows
- https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image.alpha_composite

# Next steps

1. Clean up the code, move in to functions and modules. (clean-up / organization)
2. Make a proper command-line tool that accepts a code file. (organization)
3. Support console output. (big)
4. Config file? API? One command to generate all the images I need for my slide deck. Nox extension?


# Today's stream

1. Clean up the code, move in to functions and modules. (clean-up / organization)
2. Make a proper command-line tool that accepts a code file. (organization)


# Things we want to be command-line arguments

1. Theme
2. Font, font size, line spacing
3. Programming language (autodetect?)
4. Min/max window size (in columns)
5. Window padding, window border radius
6. Drop shadow params?
7. Line ranges in the file.
8. Highlight line(s)
